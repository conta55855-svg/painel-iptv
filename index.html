<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Admin Cloud</title>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.1.3/firebase-database-compat.js"></script>
    <style>
        :root { --primary: #00ff88; --bg: #121212; --card: #1e1e1e; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: white; margin: 0; padding: 20px; }
        .container { max-width: 600px; margin: auto; background: var(--card); padding: 25px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { text-align: center; color: var(--primary); margin-top: 0; }
        .section { margin-bottom: 20px; border-bottom: 1px solid #333; padding-bottom: 20px; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #333; background: #252525; color: white; box-sizing: border-box; outline: none; }
        input:focus { border-color: var(--primary); }
        button { width: 100%; padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; transition: 0.3s; }
        .btn-add { background: var(--primary); color: #000; margin-top: 10px; }
        .btn-add:hover { background: #00cc6e; transform: translateY(-2px); }
        .link-vlc { background: #000; padding: 15px; border-radius: 8px; border: 1px dashed var(--primary); font-family: monospace; font-size: 13px; margin-top: 15px; word-break: break-all; color: var(--primary); cursor: pointer; }
        .item { background: #252525; padding: 12px; margin-top: 10px; border-radius: 8px; display: flex; justify-content: space-between; align-items: center; border-left: 4px solid var(--primary); }
        .btn-del { background: #ff4444; width: auto; padding: 6px 12px; font-size: 12px; }
    </style>
</head>
<body>

<div class="container">
    <h2>ðŸ“¡ IPTV Cloud Admin</h2>
    
    <div class="section">
        <label>Chave de Acesso:</label>
        <input type="password" id="adminPass" placeholder="Digite sua senha para gerenciar">
    </div>

    <div class="section">
        <input type="text" id="titulo" placeholder="Nome do VÃ­deo (Ex: Solo Leveling Ep 01)">
        <input type="text" id="url" placeholder="URL do VÃ­deo (.mp4)">
        <input type="text" id="ref" placeholder="Referer (Opcional)">
        <button class="btn-add" onclick="salvar()">Adicionar Ã  Nuvem</button>
    </div>

    <div>
        <strong>Link para colar no VLC:</strong>
        <div class="link-vlc" id="vlcDisplay" onclick="copiarLink()">Carregando link...</div>
    </div>

    <div id="listaItens"></div>
</div>

<script>
    // --- CONFIGURAÃ‡ÃƒO DO FIREBASE ---
    const firebaseConfig = {
        apiKey: "SUA_API_KEY",
        databaseURL: "SUA_DATABASE_URL",
        projectId: "SEU_PROJETO_ID"
    };
    
    const MINHA_SENHA = "1234"; // <--- ALTERE SUA SENHA AQUI

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    function salvar() {
        const pass = document.getElementById('adminPass').value;
        const titulo = document.getElementById('titulo').value;
        const url = document.getElementById('url').value;
        const ref = document.getElementById('ref').value;

        if(pass !== MINHA_SENHA) return alert("Chave de acesso invÃ¡lida!");
        if(!titulo || !url) return alert("Preencha tÃ­tulo e URL!");

        db.ref('listas/geral').push({
            titulo, url, ref,
            ua: "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36"
        });

        document.getElementById('titulo').value = '';
        document.getElementById('url').value = '';
    }

    function deletar(id) {
        const pass = document.getElementById('adminPass').value;
        if(pass !== MINHA_SENHA) return alert("Senha necessÃ¡ria!");
        if(confirm("Excluir vÃ­deo?")) db.ref('listas/geral/' + id).remove();
    }

    // Gerar Link do VLC baseado na URL atual
    const linkFinal = window.location.href.replace('index.html', '') + 'lista.html';
    document.getElementById('vlcDisplay').innerText = linkFinal;

    function copiarLink() {
        navigator.clipboard.writeText(linkFinal);
        alert("Link copiado para o VLC!");
    }

    // Carregar Lista
    db.ref('listas/geral').on('value', snap => {
        const listDiv = document.getElementById('listaItens');
        listDiv.innerHTML = "<p>VÃ­deos Salvos:</p>";
        snap.forEach(child => {
            const v = child.val();
            listDiv.innerHTML += `
                <div class="item">
                    <span>${v.titulo}</span>
                    <button class="btn-del" onclick="deletar('${child.key}')">Remover</button>
                </div>`;
        });
    });
</script>
</body>
</html>
